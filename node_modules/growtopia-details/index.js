let got = require("got");

/**
 * @typedef {Object} getDetailResponseWorldOfDay
 * @property {String} worldName
 * @property {String} renderURL
 */

/**
 * @typedef {Object} getDetailResponse
 * @property {Number} onlineUsersCount
 * @property {getDetailResponseWorldOfDay} worldOfDay
 */

module.exports = {
    
    /**
     *  @returns {Promise<getDetailResponse>}
     */
    getDetail(){
        return new Promise((resolve,reject)=>{
            got.get("https://www.growtopiagame.com/detail",{json:true}).then((data)=>{

                resolve({
                    onlineUsersCount: Number(data.body.online_user || "0"),
                    worldOfDay: {
                        worldName: String(data.body.world_day_images.full_size.slice(data.body.world_day_images.full_size.lastIndexOf("/")+1,data.body.world_day_images.full_size.lastIndexOf("."))).toUpperCase(),
                        renderURL: data.body.world_day_images.full_size
                    }
                });
            }).catch((data)=>{reject(data)});
        })
    }
}